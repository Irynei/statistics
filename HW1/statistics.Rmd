---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
ceodata <- read.csv('ceo.csv')
ceodata$X <- NULL
salary <- ceodata$salary
head(ceodata)
```

# 1
### 1.a

```{r}
mean(salary)
```
Mean(2027.517) - average salary.

```{r}
mean.default(salary, trim=0.1)
```
Trimmed mean(1710.092) - mean of salaries without lowest 10% and highest 10% of values.  
Used to eliminate the impact of vary large or very small salaries on the mean called outliers.

```{r}
median(salary)
```
Median(1600) - central salary. Half of salaries are smaller than median and half are larger.


```{r}
quantile(salary, c(0.25, 0.75))
```
Lower quartile(1084.0) - 25% of salaries are smaller than lower quartile (consequently 75% are larger)  
Upper quartile(2347.5) - 75% of salaries are smaller than upper quartile (consequently 25% are larger)


```{r}
quantile(salary, c(0.1,0.9))
```
Lower quartile(750.0) - 10% of salaries are smaller than lower quartile (consequently 90% are larger)  
Upper quartile(3384.4) - 90% of salaries are smaller than upper quartile (consequently 10% are larger)



### 1.b

```{r}
Fn <- ecdf(salary)
plot(Fn)
```
Empirical cumulative distribution function of salaries

```{r}
quantile(salary, c(0.2))
quantile(salary, c(0.8))
Fn(1000)
1 - Fn(5000)
```
*
  $\hat{F}^{-1}(0.2)=976.2$ - 20% of CEOs have at most $976.2 salary.  
  $\hat{F}^{-1}(0.8)=2613$ - 80% of CEOs have at most $2613 salary.

*
  $\hat{F}(1000)=0.223$ - 22.3% of CEOs have at most $1000 salary.  
  $1 - \hat{F}(5000)=0.053$ - 5.3% of CEOs have at least $5000 salary.


### 1.c

```{r}
hist(salary, col="darkolivegreen3")
```

```{r}
boxplot(salary)
```
box plot

right skewed distributions  

* the mean is meaningful only for symmetric data. this data is not symmetric
* The median can also be used to characterize asymmetric data.
* the interquartile range is robust to outliers
* There are at least [n/2] of all observations in the interval [˜x0.25, x˜0.75]




```{r}
library(ggplot2)
p <- ggplot(ceodata["salary"], aes(x=salary, y=salary)) + geom_violin()
p
```
violin-plot

### 1.d
```{r}
hist(salary, col="darkolivegreen3")
```
Histogram of salary. Default formula to compute number of bars is Sturges' formula (${\displaystyle k=\lceil \log _{2}n\rceil +1\,}$)  
For salary data $n = `r length(salary)`$, ${\displaystyle k=\lceil \log _{2}`r length(salary)`\rceil +1 = 10\,}$.
```{r}
hist(salary, breaks=4, col="darkolivegreen3")
```
Too rough histogram with only 4 bars.

```{r}
hist(salary, breaks=600, col="darkolivegreen3")
```
Too detailed histagram with 600 bars.

```{r}
a = data.frame(salary=salary)
a$veg = "salary"
b = data.frame(salary = log(salary))
b$veg = "ln salary"
ab <- rbind(a, b)
ggplot(ab, aes(salary, fill = veg)) + geom_histogram(alpha = 0.5, position ='identity')
```


### 1.e
```{r}
hist(log(salary), col="darkolivegreen3")
```
hist of ln(salary)

```{r}
boxplot(log(salary))
```
boxplot of ln(salary). We can see that this is almost symmetric distribution

```{r}
mean(log(salary))
median(log(salary))
```
mean and median of ln(salary). We can see that mean is pretty much the same as median

# 2


### 2.a


```{r}
library(ggplot2)
library(reshape2)
pearson_correlations = cor(ceodata, method="pearson")
qplot(x=Var1, y=Var2, data=melt(pearson_correlations), fill=value, geom="tile") + scale_fill_gradient(low = "white", high = "red")
```

```{r}
pairs(~salary + totcomp + tenure + age + sales + profits + assets, data=ceodata, main="Simple Scatterplot Matrix")
```

```{r}
spearman_correlation = cor(ceodata, method="spearman")
qplot(x=Var1, y=Var2, data=melt(spearman_correlation), fill=value, geom="tile") + scale_fill_gradient(low = "white", high = "red")

```

```{r}
hist(salary[which(ceodata$age > 50)],  col="darkolivegreen3", main="Age>50 and Age<50 Histograms Of Salary", xlab = "Salary")
hist(salary[which(ceodata$age < 50)],  col="tomato", add=T)
```
```{r}
plot(ecdf(salary[which(ceodata$age > 50)]), col="darkolivegreen3", main="Salary ECDF for Age>50 and Age<50")
plot(ecdf(salary[which(ceodata$age < 50)]), add=T, col="tomato")

```

# 3

### 3.a

```{r}

grouped_data = data.frame(salary=ceodata$salary, age=ceodata$age)

grouped_data$age = ifelse(grouped_data$age < 50, "a1", "a2")
grouped_data$salary[as.integer(grouped_data$salary) < 2000] <- "s1"
grouped_data$salary[as.integer(grouped_data$salary) >= 2000 & as.integer(grouped_data$salary) < 4000] <- "s2"
grouped_data$salary[as.integer(grouped_data$salary) >= 4000] <- "s3"
```

```{r}
con_table <- xtabs(~age+salary, data=grouped_data)
addmargins(con_table)
```

```{r}
con_table <- xtabs(~age+salary, data=grouped_data)
addmargins(con_table / nrow(grouped_data))
```
### 3b


### 3c
```{r}
con_table <- xtabs(~age+salary, data=grouped_data)
chisq.test(con_table)
```

# 2 Problem

# 1

```{r}
set.seed(15)
simulated <- rnorm(50, 10, 9)
norlmal <- rnorm(5000, 10, 9)
hist(norlmal, col="darkolivegreen3")
hist(simulated, col="tomato", add=T)

density(simulated)
```

```{r}
a <- dt(x = sample(50), df=5)
a <- 10 + 3 * sqrt(3 / 5) * a
hist(a)
```

